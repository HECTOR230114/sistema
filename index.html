<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEXUS Pro - Sistema Avanzado de Gestión Operacional</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap');

    :root {
      --primary: #6366f1;
      --secondary: #8b5cf6;
      --accent: #ec4899;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
      --dark: #0f172a;
      --dark-2: #1e293b;
      --dark-3: #334155;
      --light: #f1f5f9;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
      font-family: 'Outfit', sans-serif; 
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      color: #e2e8f0; 
      overflow: hidden;
    }

    .app-container {
      display: flex;
      height: 100vh;
      position: relative;
    }

    /* Sidebar mejorado */
    .sidebar {
      width: 280px;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(100, 116, 139, 0.2);
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 100;
    }

    .logo-section {
      padding: 30px 25px;
      border-bottom: 1px solid rgba(100, 116, 139, 0.2);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo-icon {
      width: 50px;
      height: 50px;
      background: var(--gradient-1);
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      animation: pulse-glow 3s infinite;
    }

    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(102, 102, 241, 0.4); }
      50% { box-shadow: 0 0 30px rgba(102, 102, 241, 0.8); }
    }

    .logo-text h1 {
      font-size: 26px;
      font-weight: 800;
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .logo-text p {
      font-size: 11px;
      color: #64748b;
      margin-top: 2px;
      font-weight: 500;
    }

    .nav-menu {
      flex: 1;
      padding: 25px 15px;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 30px;
    }

    .nav-section-title {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      color: #64748b;
      padding: 0 15px;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 15px;
      border-radius: 12px;
      color: #cbd5e1;
      text-decoration: none;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      margin-bottom: 6px;
      font-weight: 500;
    }

    .nav-item:hover {
      background: rgba(99, 102, 241, 0.1);
      color: #fff;
      transform: translateX(5px);
    }

    .nav-item.active {
      background: var(--gradient-1);
      color: white;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
    }

    .nav-item i {
      width: 20px;
      text-align: center;
      font-size: 18px;
    }

    .nav-badge {
      margin-left: auto;
      background: var(--danger);
      color: white;
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: 700;
      animation: badge-pulse 2s infinite;
    }

    @keyframes badge-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Top Bar */
    .top-bar {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(100, 116, 139, 0.2);
      padding: 20px 35px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .page-title {
      font-size: 28px;
      font-weight: 700;
      color: #fff;
    }

    .top-actions {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .search-box {
      position: relative;
    }

    .search-box input {
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid rgba(100, 116, 139, 0.3);
      padding: 12px 20px 12px 45px;
      border-radius: 12px;
      color: #e2e8f0;
      width: 300px;
      transition: all 0.3s;
    }

    .search-box input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .search-box i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #64748b;
    }

    .notification-btn {
      position: relative;
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid rgba(100, 116, 139, 0.3);
      width: 45px;
      height: 45px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .notification-btn:hover {
      background: rgba(99, 102, 241, 0.2);
      border-color: var(--primary);
    }

    .notification-dot {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 10px;
      height: 10px;
      background: var(--danger);
      border-radius: 50%;
      border: 2px solid var(--dark);
      animation: notification-pulse 2s infinite;
    }

    @keyframes notification-pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.3); opacity: 0.7; }
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 15px;
      background: rgba(30, 41, 59, 0.8);
      border: 1px solid rgba(100, 116, 139, 0.3);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .user-profile:hover {
      border-color: var(--primary);
    }

    .user-avatar {
      width: 38px;
      height: 38px;
      border-radius: 10px;
      background: var(--gradient-2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .user-info {
      text-align: left;
    }

    .user-name {
      font-size: 14px;
      font-weight: 600;
      color: #fff;
    }

    .user-role {
      font-size: 11px;
      color: #64748b;
    }

    /* Content Area */
    .content-area {
      flex: 1;
      padding: 30px 35px;
      overflow-y: auto;
    }

    .view-section {
      display: none;
      animation: fadeIn 0.4s;
    }

    .view-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 116, 139, 0.2);
      border-radius: 20px;
      padding: 25px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-1);
    }

    .stat-card.danger::before { background: var(--gradient-2); }
    .stat-card.success::before { background: var(--gradient-4); }
    .stat-card.info::before { background: var(--gradient-3); }

    .stat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .stat-title {
      font-size: 13px;
      color: #94a3b8;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-icon {
      width: 45px;
      height: 45px;
      border-radius: 12px;
      background: rgba(99, 102, 241, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--primary);
    }

    .stat-value {
      font-size: 36px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 8px;
    }

    .stat-change {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 600;
    }

    .stat-change.positive { color: var(--success); }
    .stat-change.negative { color: var(--danger); }

    /* Charts Grid */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .chart-card {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 116, 139, 0.2);
      border-radius: 20px;
      padding: 25px;
      position: relative;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .chart-title {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
    }

    .chart-actions {
      display: flex;
      gap: 10px;
    }

    .btn-icon {
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid rgba(99, 102, 241, 0.3);
      width: 35px;
      height: 35px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      color: var(--primary);
    }

    .btn-icon:hover {
      background: var(--primary);
      color: white;
    }

    .chart-container {
      height: 300px;
      position: relative;
    }

    /* Table Styles */
    .data-table {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 116, 139, 0.2);
      border-radius: 20px;
      overflow: hidden;
    }

    .table-header {
      padding: 20px 25px;
      border-bottom: 1px solid rgba(100, 116, 139, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-title {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
    }

    .table-filters {
      display: flex;
      gap: 12px;
    }

    .filter-btn {
      padding: 10px 18px;
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid rgba(99, 102, 241, 0.3);
      border-radius: 10px;
      color: var(--primary);
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      font-size: 13px;
    }

    .filter-btn:hover, .filter-btn.active {
      background: var(--primary);
      color: white;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: rgba(30, 41, 59, 0.5);
    }

    th {
      padding: 18px 25px;
      text-align: left;
      font-weight: 700;
      color: #94a3b8;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    td {
      padding: 18px 25px;
      border-top: 1px solid rgba(100, 116, 139, 0.1);
      color: #cbd5e1;
    }

    tbody tr {
      transition: all 0.3s;
    }

    tbody tr:hover {
      background: rgba(99, 102, 241, 0.05);
    }

    .priority-badge {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      display: inline-block;
    }

    .priority-critical {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .priority-high {
      background: rgba(245, 158, 11, 0.2);
      color: #f59e0b;
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .priority-medium {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .priority-low {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-open {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }

    .status-progress {
      background: rgba(245, 158, 11, 0.2);
      color: #f59e0b;
    }

    .status-resolved {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }

    .action-btn {
      padding: 8px 16px;
      background: var(--gradient-1);
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      font-size: 12px;
    }

    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--dark);
      border: 1px solid rgba(100, 116, 139, 0.3);
      border-radius: 24px;
      max-width: 800px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      animation: modalSlideIn 0.3s;
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      padding: 30px;
      border-bottom: 1px solid rgba(100, 116, 139, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #fff;
    }

    .modal-close {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      color: var(--danger);
      font-size: 20px;
    }

    .modal-close:hover {
      background: var(--danger);
      color: white;
    }

    .modal-body {
      padding: 30px;
    }

    .modal-footer {
      padding: 20px 30px;
      border-top: 1px solid rgba(100, 116, 139, 0.2);
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      font-size: 14px;
    }

    .btn-primary {
      background: var(--gradient-1);
      color: white;
    }

    .btn-secondary {
      background: rgba(100, 116, 139, 0.2);
      color: #cbd5e1;
      border: 1px solid rgba(100, 116, 139, 0.3);
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    /* Live Feed */
    .live-feed {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 116, 139, 0.2);
      border-radius: 20px;
      padding: 25px;
      height: 600px;
      overflow-y: auto;
    }

    .feed-item {
      padding: 15px;
      border-left: 3px solid var(--primary);
      background: rgba(30, 41, 59, 0.5);
      border-radius: 10px;
      margin-bottom: 12px;
      animation: slideIn 0.4s;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .feed-item.critical {
      border-left-color: var(--danger);
      background: rgba(239, 68, 68, 0.1);
    }

    .feed-time {
      font-size: 11px;
      color: #64748b;
      margin-bottom: 5px;
    }

    .feed-message {
      color: #cbd5e1;
      font-size: 14px;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(30, 41, 59, 0.5);
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(99, 102, 241, 0.5);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo-section">
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-atom"></i>
          </div>
          <div class="logo-text">
            <h1>NEXUS Pro</h1>
            <p>Operational Intelligence</p>
          </div>
        </div>
      </div>

      <nav class="nav-menu">
        <div class="nav-section">
          <div class="nav-section-title">Principal</div>
          <a href="#dashboard" class="nav-item active" data-view="dashboard">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
          </a>
          <a href="#incidents" class="nav-item" data-view="incidents">
            <i class="fas fa-exclamation-circle"></i>
            <span>Incidencias</span>
            <span class="nav-badge" id="incidents-badge">0</span>
          </a>
          <a href="#analytics" class="nav-item" data-view="analytics">
            <i class="fas fa-chart-pie"></i>
            <span>Analytics IA</span>
          </a>
          <a href="#monitoring" class="nav-item" data-view="monitoring">
            <i class="fas fa-desktop"></i>
            <span>Monitoreo</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Gestión</div>
          <a href="#problems" class="nav-item" data-view="problems">
            <i class="fas fa-bug"></i>
            <span>Problemas</span>
            <span class="nav-badge" id="problems-badge">0</span>
          </a>
          <a href="#changes" class="nav-item" data-view="changes">
            <i class="fas fa-sync-alt"></i>
            <span>Cambios</span>
          </a>
          <a href="#assets" class="nav-item" data-view="assets">
            <i class="fas fa-server"></i>
            <span>Activos</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Sistema</div>
          <a href="#reports" class="nav-item" data-view="reports">
            <i class="fas fa-file-alt"></i>
            <span>Reportes</span>
          </a>
          <a href="#settings" class="nav-item" data-view="settings">
            <i class="fas fa-cog"></i>
            <span>Configuración</span>
          </a>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Top Bar -->
      <header class="top-bar">
        <h1 class="page-title" id="page-title">Dashboard Inteligente</h1>
        
        <div class="top-actions">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Buscar incidencias, activos..." id="global-search" />
          </div>

          <div class="notification-btn" id="notification-btn">
            <i class="fas fa-bell"></i>
            <div class="notification-dot" id="notification-dot"></div>
          </div>

          <div class="user-profile">
            <div class="user-avatar">AD</div>
            <div class="user-info">
              <div class="user-name">Admin</div>
              <div class="user-role">Administrador</div>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Dashboard View -->
        <section id="dashboard" class="view-section active">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <div class="stat-title">Incidencias Activas</div>
                <div class="stat-icon" style="background: rgba(239, 68, 68, 0.2); color: var(--danger);">
                  <i class="fas fa-exclamation-triangle"></i>
                </div>
              </div>
              <div class="stat-value" id="stat-active">0</div>
              <div class="stat-change negative">
                <i class="fas fa-arrow-up"></i>
                <span>+12% vs ayer</span>
              </div>
            </div>

            <div class="stat-card danger">
              <div class="stat-header">
                <div class="stat-title">Críticas</div>
                <div class="stat-icon" style="background: rgba(236, 72, 153, 0.2); color: var(--accent);">
                  <i class="fas fa-fire"></i>
                </div>
              </div>
              <div class="stat-value" id="stat-critical">0</div>
              <div class="stat-change negative">
                <i class="fas fa-arrow-up"></i>
                <span>+3 hoy</span>
              </div>
            </div>

            <div class="stat-card success">
              <div class="stat-header">
                <div class="stat-title">Resueltas Hoy</div>
                <div class="stat-icon" style="background: rgba(16, 185, 129, 0.2); color: var(--success);">
                  <i class="fas fa-check-circle"></i>
                </div>
              </div>
              <div class="stat-value" id="stat-resolved">0</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-down"></i>
                <span>+18% vs ayer</span>
              </div>
            </div>

            <div class="stat-card info">
              <div class="stat-header">
                <div class="stat-title">Tiempo Promedio</div>
                <div class="stat-icon" style="background: rgba(59, 130, 246, 0.2); color: var(--info);">
                  <i class="fas fa-clock"></i>
                </div>
              </div>
              <div class="stat-value" id="stat-mttr">2.4h</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-down"></i>
                <span>-15% mejora</span>
              </div>
            </div>
          </div>

          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Incidencias por Prioridad</div>
                <div class="chart-actions">
                  <div class="btn-icon"><i class="fas fa-download"></i></div>
                  <div class="btn-icon"><i class="fas fa-expand"></i></div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="chart-priority"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Tendencia Últimos 30 Días</div>
                <div class="chart-actions">
                  <div class="btn-icon"><i class="fas fa-download"></i></div>
                  <div class="btn-icon"><i class="fas fa-expand"></i></div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="chart-trend"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Servicios Más Afectados</div>
                <div class="chart-actions">
                  <div class="btn-icon"><i class="fas fa-download"></i></div>
                  <div class="btn-icon"><i class="fas fa-expand"></i></div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="chart-services"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Predicción IA (Próximos 7 Días)</div>
                <div class="chart-actions">
                  <div class="btn-icon"><i class="fas fa-robot"></i></div>
                  <div class="btn-icon"><i class="fas fa-expand"></i></div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="chart-prediction"></canvas>
              </div>
            </div>
          </div>

          <div class="chart-card">
            <div class="chart-header">
              <div class="chart-title"><i class="fas fa-broadcast-tower"></i> Actividad en Tiempo Real</div>
            </div>
            <div class="live-feed" id="live-feed"></div>
          </div>
        </section>

        <!-- Incidents View -->
        <section id="incidents" class="view-section">
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Gestión de Incidencias</div>
              <div class="table-filters">
                <button class="filter-btn active" data-filter="all">Todas</button>
                <button class="filter-btn" data-filter="critical">Críticas</button>
                <button class="filter-btn" data-filter="open">Abiertas</button>
                <button class="filter-btn" data-filter="resolved">Resueltas</button>
              </div>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Fecha/Hora</th>
                  <th>Título</th>
                  <th>Servicio</th>
                  <th>Prioridad</th>
                  <th>Estado</th>
                  <th>Asignado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="incidents-tbody"></tbody>
            </table>
          </div>
        </section>

        <!-- Analytics View -->
        <section id="analytics" class="view-section">
          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Análisis de Performance</div>
              </div>
              <div class="chart-container">
                <canvas id="chart-performance"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Distribución por Equipos</div>
              </div>
              <div class="chart-container">
                <canvas id="chart-teams"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">Heatmap de Incidencias</div>
              </div>
              <div class="chart-container">
                <canvas id="chart-heatmap"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <div class="chart-title">SLA Compliance</div>
              </div>
              <div class="chart-container">
                <canvas id="chart-sla"></canvas>
              </div>
            </div>
          </div>
        </section>

        <!-- Monitoring View -->
        <section id="monitoring" class="view-section">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <div class="stat-title">CPU Usage</div>
                <div class="stat-icon" style="background: rgba(99, 102, 241, 0.2); color: var(--primary);">
                  <i class="fas fa-microchip"></i>
                </div>
              </div>
              <div class="stat-value">67%</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-down"></i>
                <span>Normal</span>
              </div>
            </div>

            <div class="stat-card success">
              <div class="stat-header">
                <div class="stat-title">Memoria RAM</div>
                <div class="stat-icon" style="background: rgba(16, 185, 129, 0.2); color: var(--success);">
                  <i class="fas fa-memory"></i>
                </div>
              </div>
              <div class="stat-value">8.2GB</div>
              <div class="stat-change positive">
                <span>de 16GB</span>
              </div>
            </div>

            <div class="stat-card info">
              <div class="stat-header">
                <div class="stat-title">Uptime</div>
                <div class="stat-icon" style="background: rgba(59, 130, 246, 0.2); color: var(--info);">
                  <i class="fas fa-arrow-up"></i>
                </div>
              </div>
              <div class="stat-value">99.9%</div>
              <div class="stat-change positive">
                <span>Excelente</span>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <div class="stat-title">Requests/seg</div>
                <div class="stat-icon" style="background: rgba(245, 158, 11, 0.2); color: var(--warning);">
                  <i class="fas fa-tachometer-alt"></i>
                </div>
              </div>
              <div class="stat-value">1.2K</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+8%</span>
              </div>
            </div>
          </div>

          <div class="chart-card">
            <div class="chart-header">
              <div class="chart-title">Monitoreo de Servidores en Tiempo Real</div>
            </div>
            <div class="chart-container" style="height: 400px;">
              <canvas id="chart-servers"></canvas>
            </div>
          </div>
        </section>

        <!-- Problems View -->
        <section id="problems" class="view-section">
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Gestión de Problemas ITIL</div>
            </div>
            <div id="problems-list" style="padding: 25px;"></div>
          </div>
        </section>

        <!-- Changes View -->
        <section id="changes" class="view-section">
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Control de Cambios</div>
              <button class="filter-btn">+ Nuevo Cambio</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ID Cambio</th>
                  <th>Descripción</th>
                  <th>Tipo</th>
                  <th>Riesgo</th>
                  <th>Estado</th>
                  <th>Fecha Programada</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="changes-tbody">
                <tr>
                  <td><strong>CHG0001</strong></td>
                  <td>Actualización sistema operativo servidor principal</td>
                  <td><span class="priority-badge priority-high">NORMAL</span></td>
                  <td><span class="priority-badge priority-medium">MEDIO</span></td>
                  <td><span class="status-badge status-progress"><i class="fas fa-spinner"></i> En Revisión</span></td>
                  <td>2025-11-20 22:00</td>
                  <td><button class="action-btn">Ver Detalle</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Assets View -->
        <section id="assets" class="view-section">
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Gestión de Activos IT</div>
              <button class="filter-btn">+ Registrar Activo</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ID Activo</th>
                  <th>Nombre</th>
                  <th>Tipo</th>
                  <th>Ubicación</th>
                  <th>Estado</th>
                  <th>Última Actualización</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="assets-tbody">
                <tr>
                  <td><strong>SRV-001</strong></td>
                  <td>Servidor Principal DB</td>
                  <td>Servidor</td>
                  <td>Datacenter A - Rack 3</td>
                  <td><span class="status-badge status-resolved"><i class="fas fa-check"></i> Operativo</span></td>
                  <td>2025-11-18 14:25</td>
                  <td><button class="action-btn">Gestionar</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Reports View -->
        <section id="reports" class="view-section">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <div class="stat-title">Reporte Mensual</div>
                <div class="stat-icon" style="background: rgba(99, 102, 241, 0.2); color: var(--primary);">
                  <i class="fas fa-file-pdf"></i>
                </div>
              </div>
              <button class="action-btn" style="margin-top: 20px;">Generar PDF</button>
            </div>

            <div class="stat-card success">
              <div class="stat-header">
                <div class="stat-title">Exportar Datos</div>
                <div class="stat-icon" style="background: rgba(16, 185, 129, 0.2); color: var(--success);">
                  <i class="fas fa-file-excel"></i>
                </div>
              </div>
              <button class="action-btn" style="margin-top: 20px;">Descargar Excel</button>
            </div>

            <div class="stat-card info">
              <div class="stat-header">
                <div class="stat-title">Análisis Completo</div>
                <div class="stat-icon" style="background: rgba(59, 130, 246, 0.2); color: var(--info);">
                  <i class="fas fa-chart-bar"></i>
                </div>
              </div>
              <button class="action-btn" style="margin-top: 20px;">Ver Análisis</button>
            </div>

            <div class="stat-card danger">
              <div class="stat-header">
                <div class="stat-title">Dashboard Ejecutivo</div>
                <div class="stat-icon" style="background: rgba(236, 72, 153, 0.2); color: var(--accent);">
                  <i class="fas fa-presentation"></i>
                </div>
              </div>
              <button class="action-btn" style="margin-top: 20px;">Presentación</button>
            </div>
          </div>
        </section>

        <!-- Settings View -->
        <section id="settings" class="view-section">
          <div class="data-table">
            <div class="table-header">
              <div class="table-title">Configuración del Sistema</div>
            </div>
            <div style="padding: 30px;">
              <h3 style="color: #fff; margin-bottom: 20px;">Preferencias Generales</h3>
              <p style="color: #94a3b8;">Configuración del sistema en desarrollo...</p>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Modal Detail -->
  <div class="modal" id="detail-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Detalle de Incidencia</h2>
        <div class="modal-close" id="modal-close">
          <i class="fas fa-times"></i>
        </div>
      </div>
      <div class="modal-body" id="modal-body"></div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="btn-cancel">Cancelar</button>
        <button class="btn btn-primary" id="btn-resolve">Resolver Incidencia</button>
        <button class="btn btn-primary" id="btn-problem">Crear Problema</button>
      </div>
    </div>
  </div>

  <audio id="alert-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-tone-1054.mp3" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // NEXUS Pro - Sistema Avanzado de Gestión
    let incidents = [];
    let problems = [];
    let charts = {};
    let notificationCount = 0;

    const services = ["Motor IA", "API Gateway", "Base de Datos", "Autenticación", "Cache Redis", "Storage S3"];
    const teams = ["DevOps", "Backend", "Frontend", "Infraestructura", "QA", "Seguridad"];
    const priorities = ["Crítica", "Alta", "Media", "Baja"];
    const statuses = ["Abierta", "En Progreso", "Resuelta"];

    // Inicialización
    window.onload = () => {
      initializeSystem();
      setupNavigation();
      setupEventListeners();
      createAllCharts();
      
      // Intervalos de actualización
      setInterval(generateAutoIncident, 7000);
      setInterval(updateSystem, 4000);
      setInterval(updateCharts, 10000);
    };

    function initializeSystem() {
      // Generar incidencias iniciales
      for (let i = 0; i < 45; i++) {
        generateAutoIncident(true);
      }
      updateSystem();
    }

    function generateAutoIncident(silent = false) {
      const service = services[Math.floor(Math.random() * services.length)];
      const priority = Math.random() < 0.15 ? "Crítica" : priorities[Math.floor(Math.random() * priorities.length)];
      const status = Math.random() < 0.7 ? "Abierta" : statuses[Math.floor(Math.random() * statuses.length)];
      
      const incident = {
        id: `INC-${String(incidents.length + 10001).padStart(6, '0')}`,
        title: priority === "Crítica" 
          ? `FALLO CRÍTICO - ${service} sin respuesta` 
          : `Error de rendimiento en ${service}`,
        service,
        priority,
        status,
        assignedTo: teams[Math.floor(Math.random() * teams.length)],
        date: new Date().toLocaleDateString('es-ES'),
        time: new Date().toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' }),
        timestamp: new Date().getTime(),
        sla: Math.random() < 0.92,
        mttr: priority === "Crítica" ? (Math.random() * 4 + 1).toFixed(1) : (Math.random() * 15 + 3).toFixed(1),
        description: `Incidencia detectada en ${service}. Se requiere investigación inmediata.`
      };

      incidents.unshift(incident);

      if (!silent) {
        if (priority === "Crítica") {
          playAlert();
          showNotification("¡Incidencia CRÍTICA detectada!");
        }
        addToLiveFeed(`NUEVA → ${incident.id} | ${incident.title}`, priority === "Crítica");
        detectRecurrentProblems();
      }
    }

    function detectRecurrentProblems() {
      services.forEach(service => {
        const openIncidents = incidents.filter(i => i.service === service && i.status === "Abierta").length;
        
        if (openIncidents >= 5 && !problems.some(p => p.service === service && p.status === "Activo")) {
          const problem = {
            id: `PRB-${String(problems.length + 3001).padStart(6, '0')}`,
            service,
            incidentCount: openIncidents,
            rootCause: "Sobrecarga del sistema - Análisis IA en progreso",
            workaround: "Reinicio programado cada 6 horas",
            status: "Activo",
            createdAt: new Date().toLocaleString('es-ES')
          };
          
          problems.push(problem);
          addToLiveFeed(`PROBLEMA DETECTADO → ${service} (${openIncidents} incidencias relacionadas)`, true);
          showNotification("Nuevo problema identificado");
        }
      });

      document.getElementById('problems-badge').textContent = problems.filter(p => p.status === "Activo").length;
      renderProblems();
    }

    function updateSystem() {
      // Actualizar KPIs
      const activeIncidents = incidents.filter(i => i.status === "Abierta" || i.status === "En Progreso").length;
      const criticalIncidents = incidents.filter(i => i.priority === "Crítica" && i.status !== "Resuelta").length;
      const resolvedToday = incidents.filter(i => i.status === "Resuelta" && i.date === new Date().toLocaleDateString('es-ES')).length;
      const avgMttr = (incidents.reduce((sum, i) => sum + parseFloat(i.mttr), 0) / incidents.length).toFixed(1);

      document.getElementById('stat-active').textContent = activeIncidents;
      document.getElementById('stat-critical').textContent = criticalIncidents;
      document.getElementById('stat-resolved').textContent = resolvedToday;
      document.getElementById('stat-mttr').textContent = avgMttr + 'h';
      document.getElementById('incidents-badge').textContent = activeIncidents;

      // Renderizar tabla de incidencias
      renderIncidentsTable();
    }

    function renderIncidentsTable() {
      const tbody = document.getElementById('incidents-tbody');
      const displayIncidents = incidents.slice(0, 25);
      
      tbody.innerHTML = displayIncidents.map(inc => `
        <tr>
          <td><strong>${inc.id}</strong></td>
          <td>${inc.date}<br><small style="color: #64748b;">${inc.time}</small></td>
          <td>${inc.title}</td>
          <td>${inc.service}</td>
          <td><span class="priority-badge priority-${inc.priority.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")}">${inc.priority}</span></td>
          <td><span class="status-badge status-${inc.status === 'Abierta' ? 'open' : inc.status === 'En Progreso' ? 'progress' : 'resolved'}">
            <i class="fas fa-${inc.status === 'Abierta' ? 'exclamation-circle' : inc.status === 'En Progreso' ? 'spinner' : 'check-circle'}"></i>
            ${inc.status}
          </span></td>
          <td>${inc.assignedTo}</td>
          <td><button class="action-btn" onclick="showIncidentDetail('${inc.id}')">Ver Detalle</button></td>
        </tr>
      `).join('');
    }

    function renderProblems() {
      const container = document.getElementById('problems-list');
      if (problems.length === 0) {
        container.innerHTML = '<p style="color: #94a3b8; text-align: center; padding: 40px;">No hay problemas recurrentes detectados</p>';
        return;
      }

      container.innerHTML = problems.map(prob => `
        <div style="background: rgba(30, 41, 59, 0.5); padding: 25px; border-radius: 16px; margin-bottom: 20px; border-left: 4px solid ${prob.status === 'Activo' ? '#ef4444' : '#10b981'};">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
            <h3 style="color: #fff; font-size: 18px;">${prob.id} - Problema en ${prob.service}</h3>
            <span class="status-badge ${prob.status === 'Activo' ? 'status-open' : 'status-resolved'}">${prob.status}</span>
          </div>
          <p style="color: #cbd5e1; margin-bottom: 10px;"><strong>Incidencias relacionadas:</strong> ${prob.incidentCount}</p>
          <p style="color: #cbd5e1; margin-bottom: 10px;"><strong>Causa raíz (IA):</strong> ${prob.rootCause}</p>
          <p style="color: #cbd5e1; margin-bottom: 10px;"><strong>Solución temporal:</strong> ${prob.workaround}</p>
          <p style="color: #64748b; font-size: 12px;"><i class="fas fa-clock"></i> Creado: ${prob.createdAt}</p>
        </div>
      `).join('');
    }

    function showIncidentDetail(id) {
      const incident = incidents.find(i => i.id === id);
      if (!incident) return;

      const modal = document.getElementById('detail-modal');
      const modalBody = document.getElementById('modal-body');
      
      modalBody.innerHTML = `
        <div style="margin-bottom: 20px;">
          <h3 style="color: #fff; font-size: 20px; margin-bottom: 15px;">${incident.id} - ${incident.title}</h3>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">SERVICIO</p>
              <p style="color: #cbd5e1; font-weight: 600;">${incident.service}</p>
            </div>
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">PRIORIDAD</p>
              <span class="priority-badge priority-${incident.priority.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")}">${incident.priority}</span>
            </div>
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">ASIGNADO A</p>
              <p style="color: #cbd5e1; font-weight: 600;">${incident.assignedTo}</p>
            </div>
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">ESTADO</p>
              <span class="status-badge status-${incident.status === 'Abierta' ? 'open' : incident.status === 'En Progreso' ? 'progress' : 'resolved'}">${incident.status}</span>
            </div>
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">SLA</p>
              <p style="color: ${incident.sla ? '#10b981' : '#ef4444'}; font-weight: 600;">${incident.sla ? 'Cumplido ✓' : 'Incumplido ✗'}</p>
            </div>
            <div>
              <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">MTTR</p>
              <p style="color: #cbd5e1; font-weight: 600;">${incident.mttr} horas</p>
            </div>
          </div>
          <div style="margin-top: 20px;">
            <p style="color: #64748b; font-size: 12px; margin-bottom: 5px;">DESCRIPCIÓN</p>
            <p style="color: #cbd5e1;">${incident.description}</p>
          </div>
        </div>
      `;
      
      modal.classList.add('active');
    }

    function addToLiveFeed(message, isCritical = false) {
      const feed = document.getElementById('live-feed');
      const item = document.createElement('div');
      item.className = `feed-item ${isCritical ? 'critical' : ''}`;
      item.innerHTML = `
        <div class="feed-time">${new Date().toLocaleTimeString('es-ES')}</div>
        <div class="feed-message">${message}</div>
      `;
      feed.insertBefore(item, feed.firstChild);
      
      // Limitar a 50 items
      while (feed.children.length > 50) {
        feed.removeChild(feed.lastChild);
      }
    }

    function showNotification(message) {
      notificationCount++;
      const dot = document.getElementById('notification-dot');
      dot.style.display = 'block';
      addToLiveFeed(`NOTIFICACIÓN → ${message}`);
    }

    function playAlert() {
      const audio = document.getElementById('alert-sound');
      audio.play().catch(() => {});
    }

    function createAllCharts() {
      const chartColors = {
        primary: '#6366f1',
        secondary: '#8b5cf6',
        accent: '#ec4899',
        success: '#10b981',
        warning: '#f59e0b',
        danger: '#ef4444',
        info: '#3b82f6'
      };

      // Chart 1: Priority Distribution
      const ctxPriority = document.getElementById('chart-priority').getContext('2d');
      charts.priority = new Chart(ctxPriority, {
        type: 'doughnut',
        data: {
          labels: priorities,
          datasets: [{
            data: priorities.map(p => incidents.filter(i => i.priority === p).length),
            backgroundColor: [chartColors.danger, chartColors.warning, chartColors.info, chartColors.success],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: { color: '#cbd5e1', font: { size: 12 } }
            }
          }
        }
      });

      // Chart 2: Trend
      const ctxTrend = document.getElementById('chart-trend').getContext('2d');
      charts.trend = new Chart(ctxTrend, {
        type: 'line',
        data: {
          labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
          datasets: [{
            label: 'Incidencias',
            data: [45, 68, 82, incidents.length],
            borderColor: chartColors.accent,
            backgroundColor: 'rgba(236, 72, 153, 0.1)',
            tension: 0.4,
            fill: true,
            borderWidth: 3
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#cbd5e1' } }
          },
          scales: {
            y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(100, 116, 139, 0.1)' } },
            x: { ticks: { color: '#64748b' }, grid: { display: false } }
          }
        }
      });

      // Chart 3: Services
      const ctxServices = document.getElementById('chart-services').getContext('2d');
      charts.services = new Chart(ctxServices, {
        type: 'bar',
        data: {
          labels: services,
          datasets: [{
            label: 'Incidencias',
            data: services.map(s => incidents.filter(i => i.service === s).length),
            backgroundColor: chartColors.primary,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(100, 116, 139, 0.1)' } },
            x: { ticks: { color: '#64748b' }, grid: { display: false } }
          }
        }
      });

      // Chart 4: AI Prediction
      const ctxPrediction = document.getElementById('chart-prediction').getContext('2d');
      charts.prediction = new Chart(ctxPrediction, {
        type: 'line',
        data: {
          labels: ['Hoy', 'Mañana', 'D+2', 'D+3', 'D+4', 'D+5', 'D+6'],
          datasets: [{
            label: 'Predicción IA',
            data: [incidents.length, incidents.length + 12, incidents.length + 28, incidents.length + 35, incidents.length + 30, incidents.length + 22, incidents.length + 18],
            borderColor: chartColors.secondary,
            backgroundColor: 'rgba(139, 92, 246, 0.1)',
            tension: 0.4,
            fill: true,
            borderWidth: 3,
            pointBackgroundColor: chartColors.secondary,
            pointRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#cbd5e1' } }
          },
          scales: {
            y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(100, 116, 139, 0.1)' } },
            x: { ticks: { color: '#64748b' }, grid: { display: false } }
          }
        }
      });

      // Chart 5: Performance
      const ctxPerformance = document.getElementById('chart-performance').getContext('2d');
      charts.performance = new Chart(ctxPerformance, {
        type: 'radar',
        data: {
          labels: ['Velocidad', 'Calidad', 'Eficiencia', 'SLA', 'Satisfacción', 'Innovación'],
          datasets: [{
            label: 'Performance Actual',
            data: [85, 92, 78, 94, 88, 82],
            backgroundColor: 'rgba(99, 102, 241, 0.2)',
            borderColor: chartColors.primary,
            borderWidth: 3,
            pointBackgroundColor: chartColors.primary,
            pointRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#cbd5e1' } }
          },
          scales: {
            r: {
              ticks: { color: '#64748b', backdropColor: 'transparent' },
              grid: { color: 'rgba(100, 116, 139, 0.2)' },
              pointLabels: { color: '#cbd5e1' }
            }
          }
        }
      });

      // Chart 6: Teams
      const ctxTeams = document.getElementById('chart-teams').getContext('2d');
      charts.teams = new Chart(ctxTeams, {
        type: 'polarArea',
        data: {
          labels: teams,
          datasets: [{
            data: teams.map(t => incidents.filter(i => i.assignedTo === t).length),
            backgroundColor: [
              'rgba(99, 102, 241, 0.6)',
              'rgba(139, 92, 246, 0.6)',
              'rgba(236, 72, 153, 0.6)',
              'rgba(16, 185, 129, 0.6)',
              'rgba(245, 158, 11, 0.6)',
              'rgba(59, 130, 246, 0.6)'
            ]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { position: 'right', labels: { color: '#cbd5e1' } }
          },
          scales: {
            r: {
              ticks: { color: '#64748b', backdropColor: 'transparent' },
              grid: { color: 'rgba(100, 116, 139, 0.2)' }
            }
          }
        }
      });

      // Chart 7: Heatmap (usando bar horizontal)
      const ctxHeatmap = document.getElementById('chart-heatmap').getContext('2d');
      const hours = Array(24).fill(0);
      incidents.forEach(i => {
        const hour = new Date(i.timestamp).getHours();
        hours[hour]++;
      });
      
      charts.heatmap = new Chart(ctxHeatmap, {
        type: 'bar',
        data: {
          labels: Array.from({length: 24}, (_, i) => `${i}:00`),
          datasets: [{
            label: 'Incidencias por Hora',
            data: hours,
            backgroundColor: hours.map(val => {
              const intensity = val / Math.max(...hours);
              return `rgba(236, 72, 153, ${0.3 + intensity * 0.7})`;
            }),
            borderRadius: 6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(100, 116, 139, 0.1)' } },
            x: { ticks: { color: '#64748b', maxRotation: 45, minRotation: 45 }, grid: { display: false } }
          }
        }
      });

      // Chart 8: SLA
      const ctxSLA = document.getElementById('chart-sla').getContext('2d');
      charts.sla = new Chart(ctxSLA, {
        type: 'bar',
        data: {
          labels: services,
          datasets: [{
            label: 'SLA Cumplido %',
            data: services.map(s => {
              const serviceIncidents = incidents.filter(i => i.service === s);
              const compliant = serviceIncidents.filter(i => i.sla).length;
              return serviceIncidents.length > 0 ? ((compliant / serviceIncidents.length) * 100).toFixed(1) : 0;
            }),
            backgroundColor: chartColors.success,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { 
              ticks: { color: '#64748b' }, 
              grid: { color: 'rgba(100, 116, 139, 0.1)' },
              max: 100
            },
            x: { ticks: { color: '#64748b' }, grid: { display: false } }
          }
        }
      });

      // Chart 9: Server Monitoring
      const ctxServers = document.getElementById('chart-servers').getContext('2d');
      charts.servers = new Chart(ctxServers, {
        type: 'line',
        data: {
          labels: Array.from({length: 20}, (_, i) => `-${20-i}min`),
          datasets: [
            {
              label: 'CPU %',
              data: Array.from({length: 20}, () => 40 + Math.random() * 30),
              borderColor: chartColors.primary,
              backgroundColor: 'rgba(99, 102, 241, 0.1)',
              tension: 0.4,
              fill: true,
              borderWidth: 2
            },
            {
              label: 'Memoria %',
              data: Array.from({length: 20}, () => 50 + Math.random() * 20),
              borderColor: chartColors.success,
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              tension: 0.4,
              fill: true,
              borderWidth: 2
            },
            {
              label: 'Red MB/s',
              data: Array.from({length: 20}, () => 20 + Math.random() * 40),
              borderColor: chartColors.accent,
              backgroundColor: 'rgba(236, 72, 153, 0.1)',
              tension: 0.4,
              fill: true,
              borderWidth: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: '#cbd5e1' } }
          },
          scales: {
            y: { 
              ticks: { color: '#64748b' }, 
              grid: { color: 'rgba(100, 116, 139, 0.1)' }
            },
            x: { 
              ticks: { color: '#64748b' }, 
              grid: { display: false } 
            }
          },
          animation: {
            duration: 0
          }
        }
      });
    }

    function updateCharts() {
      // Actualizar datos de los gráficos
      if (charts.priority) {
        charts.priority.data.datasets[0].data = priorities.map(p => incidents.filter(i => i.priority === p).length);
        charts.priority.update('none');
      }

      if (charts.services) {
        charts.services.data.datasets[0].data = services.map(s => incidents.filter(i => i.service === s).length);
        charts.services.update('none');
      }

      if (charts.teams) {
        charts.teams.data.datasets[0].data = teams.map(t => incidents.filter(i => i.assignedTo === t).length);
        charts.teams.update('none');
      }

      // Actualizar monitoreo de servidores con datos en tiempo real
      if (charts.servers) {
        charts.servers.data.datasets.forEach(dataset => {
          dataset.data.shift();
          dataset.data.push(dataset.label === 'CPU %' ? 40 + Math.random() * 30 :
                           dataset.label === 'Memoria %' ? 50 + Math.random() * 20 :
                           20 + Math.random() * 40);
        });
        charts.servers.update('none');
      }
    }

    function setupNavigation() {
      const navItems = document.querySelectorAll('.nav-item');
      const sections = document.querySelectorAll('.view-section');
      const pageTitle = document.getElementById('page-title');

      navItems.forEach(item => {
        item.addEventListener('click', (e) => {
          e.preventDefault();
          
          // Actualizar navegación activa
          navItems.forEach(nav => nav.classList.remove('active'));
          item.classList.add('active');

          // Mostrar sección correspondiente
          const viewId = item.getAttribute('data-view');
          sections.forEach(section => section.classList.remove('active'));
          document.getElementById(viewId).classList.add('active');

          // Actualizar título
          const titles = {
            'dashboard': 'Dashboard Inteligente',
            'incidents': 'Gestión de Incidencias',
            'analytics': 'Analytics con IA',
            'monitoring': 'Monitoreo en Tiempo Real',
            'problems': 'Gestión de Problemas',
            'changes': 'Control de Cambios',
            'assets': 'Gestión de Activos IT',
            'reports': 'Reportes y Análisis',
            'settings': 'Configuración del Sistema'
          };
          pageTitle.textContent = titles[viewId] || 'NEXUS Pro';
        });
      });
    }

    function setupEventListeners() {
      // Modal
      const modal = document.getElementById('detail-modal');
      const modalClose = document.getElementById('modal-close');
      const btnCancel = document.getElementById('btn-cancel');
      const btnResolve = document.getElementById('btn-resolve');
      const btnProblem = document.getElementById('btn-problem');

      modalClose.addEventListener('click', () => modal.classList.remove('active'));
      btnCancel.addEventListener('click', () => modal.classList.remove('active'));
      
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.classList.remove('active');
      });

      btnResolve.addEventListener('click', () => {
        addToLiveFeed('Incidencia resuelta exitosamente');
        modal.classList.remove('active');
      });

      btnProblem.addEventListener('click', () => {
        addToLiveFeed('Problema creado desde incidencia', true);
        modal.classList.remove('active');
      });

      // Filtros de tabla
      const filterBtns = document.querySelectorAll('.filter-btn');
      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          filterBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          const filter = btn.getAttribute('data-filter');
          filterIncidents(filter);
        });
      });

      // Búsqueda global
      const searchInput = document.getElementById('global-search');
      searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        if (query.length > 2) {
          addToLiveFeed(`Búsqueda: "${query}"`);
        }
      });

      // Notificaciones
      const notifBtn = document.getElementById('notification-btn');
      notifBtn.addEventListener('click', () => {
        notificationCount = 0;
        document.getElementById('notification-dot').style.display = 'none';
        addToLiveFeed('Notificaciones marcadas como leídas');
      });
    }

    function filterIncidents(filter) {
      const tbody = document.getElementById('incidents-tbody');
      let filtered = incidents;

      switch(filter) {
        case 'critical':
          filtered = incidents.filter(i => i.priority === 'Crítica');
          break;
        case 'open':
          filtered = incidents.filter(i => i.status === 'Abierta');
          break;
        case 'resolved':
          filtered = incidents.filter(i => i.status === 'Resuelta');
          break;
      }

      tbody.innerHTML = filtered.slice(0, 25).map(inc => `
        <tr>
          <td><strong>${inc.id}</strong></td>
          <td>${inc.date}<br><small style="color: #64748b;">${inc.time}</small></td>
          <td>${inc.title}</td>
          <td>${inc.service}</td>
          <td><span class="priority-badge priority-${inc.priority.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")}">${inc.priority}</span></td>
          <td><span class="status-badge status-${inc.status === 'Abierta' ? 'open' : inc.status === 'En Progreso' ? 'progress' : 'resolved'}">
            <i class="fas fa-${inc.status === 'Abierta' ? 'exclamation-circle' : inc.status === 'En Progreso' ? 'spinner' : 'check-circle'}"></i>
            ${inc.status}
          </span></td>
          <td>${inc.assignedTo}</td>
          <td><button class="action-btn" onclick="showIncidentDetail('${inc.id}')">Ver Detalle</button></td>
        </tr>
      `).join('');
    }

    // Inicializar feed en vivo
    addToLiveFeed('Sistema NEXUS Pro iniciado correctamente');
    addToLiveFeed('Módulo de IA activado y monitoreando');
    addToLiveFeed('Conexión establecida con todos los servicios');
  </script>
</body>
</html>
